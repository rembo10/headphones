<%def name="OptionString(o, parent=None)">
<%
    uiname = o.uiId()
    embed_id = uiname + '_embed'

    size_attr = '' if o.maxlength is None else ' size="%d"' % o.maxlength
    tooltip_attr = '' if o.tooltip is None else ' title="%s"' % o.tooltip
%>
    <div class="option">
        %if o.label is not None:
            <label ${tooltip_attr} for="${uiname}">
                ${o.label}
            </label>
        %endif

        <div class="input-wrapper">
            %if o.writable:
                <input type="text" id="${uiname}" name="${uiname}" value="${o.value}" ${size_attr} />
            %else:
                <span id="${uiname}" name="${uiname}">${o.value}</span>
            %endif

            %if o.caption is not None:
                <div class="small caption">${o.caption}</div>
            %endif
        </div>
    </div>

    % if 0 < len(o):
        <div id="${embed_id}">
            % for option in o:
                ${option.render(parent=o)}
            % endfor    # for option in block
        </div>
    % endif
</%def>


<%def name="OptionPassword(o, parent=None)">
<%
    uiname = o.uiId()
    embed_id = uiname + '_embed'

    size_attr = '' if o.maxlength is None else ' size="%d"' % o.maxlength
    tooltip_attr = '' if o.tooltip is None else ' title="%s"' % o.tooltip
%>
    <div class="option">
        %if o.label is not None:
            <label ${tooltip_attr} for="${uiname}">
                ${o.label}
            </label>
        %endif

        <div class="input-wrapper">
            %if o.writable:
                <input type="password" id="${uiname}" name="${uiname}" value="${o.value}" ${size_attr} />
            %else:
                <span id="${uiname}" name="${uiname}">${'*' * len(o.value)}</span>
            %endif

            %if o.caption is not None:
                <div class="small caption">${o.caption}</div>
            %endif
        </div>
    </div>
    % if 0 < len(o):
        <div id="${embed_id}">
            % for option in o:
                ${option.render(o)}
            % endfor    # for option in block
        </div>
    % endif
</%def>


<%def name="OptionNumber(o, parent=None)">
<%
    uiname = o.uiId()
    embed_id = uiname + '_embed'

    min_attr = '' if o.minvalue is None else ' min="%d"' % o.minvalue
    max_attr = '' if o.maxvalue is None else ' size="%d"' % o.maxvalue
    tooltip_attr = '' if o.tooltip is None else ' title="%s"' % o.tooltip
%>
    <div class="option">
        %if o.label is not None:
            <label ${tooltip_attr} for="${uiname}">
                ${o.label}
            </label>
        %endif

        <div class="input-wrapper">
            <input type="number" id="${uiname}" name="${uiname}" value="${o.value}" ${min_attr} ${max_attr} />

            %if o.caption is not None:
                <div class="small caption">${o.caption}</div>
            %endif
        </div>
    </div>
    % if 0 < len(o):
        <div id="${embed_id}">
            % for option in o:
                ${option.render(o)}
            % endfor    # for option in block
        </div>
    % endif
</%def>


<%def name="OptionBool(o, parent=None)">
<%
    uiname = o.uiId()
    embed_id = uiname + '_embed'

    tooltip_attr = '' if o.tooltip is None else ' title="%s"' % o.tooltip
    checked_attr = 'checked' if o.value else ''
%>
    <div class="option">
        %if o.label is not None:
            <label ${tooltip_attr} for="${uiname}">
                ${o.label}
            </label>
        %endif

        <div class="input-wrapper">
            <input type="checkbox" id="${uiname}" name="${uiname}" value="1" ${checked_attr} />

            %if o.caption is not None:
                <div class="small caption">${o.caption}</div>
            %endif
        </div>
    </div>
    % if 0 < len(o):
        <div id="${embed_id}">
            % for option in o:
                ${option.render(o)}
            % endfor    # for option in block
        </div>
    % endif
</%def>


<%def name="OptionSwitch(o, parent=None)">
<%
    uiname = o.uiId()
    embed_id = uiname + '_embed'

    tooltip_attr = '' if o.tooltip is None else ' title="%s"' % o.tooltip
    checked_attr = 'checked' if o.value else ''
%>
    <div class="option">
        %if o.label is not None:
            <label ${tooltip_attr} for="${uiname}">
                ${o.label}
            </label>
        %endif

        <div class="input-wrapper">
            <input class="hp-option-switch" type="checkbox" id="${uiname}" name="${uiname}" data-div="#${embed_id}" value="1" ${checked_attr} />

            %if o.caption is not None:
                <div class="small caption">${o.caption}</div>
            %endif
        </div>
    </div>

    % if 0 < len(o):
        <div id="${embed_id}">
            % for option in o:
                ${option.render()}
            % endfor    # for option in block
        </div>
    % endif
</%def>


## ===============================================
## TEMPLATES for
##
## TemplaterExtension
##
## Minimum of python code, just HTML and templates
## ===============================================

<%def name="ApiKeyExtension(o, parent=None)">
<%
    ext = o
    o = parent
    uiname = o.uiId()
    embed_id = uiname + '_embed'
    button_class = embed_id + '_btn_cls'
%>
<div class="option">
    <label>
        <button type="button" class="${button_class}">${ext.strings['button']}</button>
    </label>
    <div>
        <div class="small caption">${ext.strings['caption']}<strong>${o.value}</strong></div>
    </div>
</div>
<script type="text/javascript">
    $(document).ready(function(){
        $('#${uiname}').click(function(){ $('#${uiname}').select() });

        $(".${button_class}").click(function(){
            $.get('generateAPI', null, { timeout: 5000 })
                .done(
                    function done (data){
                        if (data.error != undefined) {
                            console.error(data.error);
                            alert(data.error);
                            return;
                        }
                        $('#${uiname}').val(data);
                    })
                .fail(function fail(jqXHR, status, error){
                    var msg = null;
                    if (status.message)
                        msg = status.message;
                    else if (status)
                        msg = status;

                    console.error(msg);
                    alert('Error occured:' + msg);
                });
        });
    });
</script>
</%def>


<%def name="LabelExtension(o, parent=None)">
<%
    class_attr = '' if ((not 'class' in o.strings) or (not o.strings['class'])) else ' class="%s"' % o.strings['class']
%>
    <div ${class_attr}>${o.strings['label']}</div>
</%def>
